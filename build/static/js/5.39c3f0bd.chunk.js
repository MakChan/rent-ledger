(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{456:function(e,a,t){"use strict";t.r(a);var n=t(156),r=t(34),l=t(11),i=t(0),c=t.n(i),u=t(150),m=t(154),s=t(442),o=t(61),p=t(454),d=t(151),y=t(455),b=t(453),f=t(452),g=t(227),v=t.n(g),E=t(5),P=t(443),O=t(26),h=t(22),j=(t(21),t(75)),C=t(43);function w(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function R(){var e=Object(l.a)(["\n  mutation createPayment($payment: PaymentInput!, $leaseId: String!) {\n    createPayment(payment: $payment, leaseId: $leaseId) {\n      _id\n    }\n  }\n"]);return R=function(){return e},e}function x(){var e=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  margin: 0 -0.25rem;\n\n  & > div {\n    flex: 1 1 0;\n    padding: 0.25rem;\n  }\n\n  @media (max-width: 576px) {\n    flex-direction: column;\n  }\n"]);return x=function(){return e},e}function I(){var e=Object(l.a)(["\n  font-size: 1.5rem;\n  color: ",";\n"]);return I=function(){return e},e}function k(){var e=Object(l.a)(["\n  margin: 1.25rem 0;\n  font-size: 1rem;\n\n  span {\n    font-size: 1.2rem;\n  }\n"]);return k=function(){return e},e}var D=E.default.div(k()),S=E.default.span(I(),function(e){return e.value>=0?"#00b700":"palevioletred"}),z=E.default.div(x()),$=Object(h.b)(R()),q=function(e,a){var t=0;return(t=a.lastPayment?7.5*(e-a.lastPayment.reading):7.5*(e-a.initialReading))>0?t:0},L=Object(P.a)({field:["lease","payment.reading"],updates:function(e,a,t,n){if(!t.lease)return{};var r=0;"lease"===a?(e.value.rent,t.payment.reading&&(r=q(t.payment.reading,t.lease.value))):r=q(e,t.lease.value);var l=t.lease.value.lastPayment&&(t.lease.value.lastPayment.balance?t.lease.value.lastPayment.balance:0),i=t.lease.value.extraCharges?t.lease.value.extraCharges:0;return{"payment.electricityCharges":r,totalRent:t.lease.value.rent+r+l+i}}},{field:["payment.totalPaid","payment.reading"],updates:function(e,a,t,n){return"payment.reading"!==a||t.payment.totalPaid?{"payment.balance":t.payment.totalPaid-t.totalRent}:{}}});a.default=function(){var e=Object(O.c)(j.a),a=e.data,t=e.loading,l=Object(O.b)($,{onCompleted:function(e){console.log("data",e)}}),i=Object(r.a)(l,2),g=i[0],E=i[1].data;if(t)return c.a.createElement(C.a,{size:"large"});var P=a.currentLeases.map(function(e){return{label:"".concat(e.room.roomNo," - ").concat(e.tenant.name),value:e}}),h=new Date;return E?c.a.createElement(C.b,null,c.a.createElement(v.a,{size:"xlarge",primaryColor:"green"}),c.a.createElement("div",null,"Saved")):c.a.createElement("div",{style:{padding:"1rem 2rem"}},c.a.createElement("h3",null,"Accept Payment"),c.a.createElement(s.b,{onSubmit:function(e){var a=e.lease.value._id,t=function(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?w(t,!0).forEach(function(a){Object(n.a)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}({},e.payment);t.datePaid=new Date(e.payment.datePaid),t.reading=t.reading?t.reading:e.lease.value.lastPayment.reading?e.lease.value.lastPayment.reading:e.lease.value.initialRading,t.balanceIsElectricity?(t.paidElectricityCharges=t.balance,t.balance=0):t.paidElectricityCharges=t.electricityCharges,g({variables:{leaseId:a,payment:t}})},decorators:[L],initialValues:{payment:{datePaid:h}}},function(e){var a=e.handleSubmit,t=e.submitting,n=e.values,r=e.pristine;return c.a.createElement("form",{onSubmit:a},c.a.createElement(z,null,c.a.createElement(s.a,{name:"payment.datePaid",label:"Date"},function(e){var a=e.input;return c.a.createElement(o.b,{name:"date",label:"Date",isRequired:!0},function(){return c.a.createElement(f.a,a)})}),c.a.createElement(s.a,{name:"lease",label:"Room"},function(e){var a=e.input;return c.a.createElement(o.b,{name:"lease",label:"Room",isRequired:!0},function(){return c.a.createElement(b.a,Object.assign({},a,{options:P,placeholder:"Choose a room"}))})})),n.lease&&c.a.createElement(c.a.Fragment,null,c.a.createElement(D,null,"Previous Reading :"," ",c.a.createElement("span",null,n.lease.value.lastPayment&&n.lease.value.lastPayment.reading?n.lease.value.lastPayment.reading:n.lease.value.initialReading)),c.a.createElement(s.a,{name:"payment.reading",label:"Current Reading",parse:function(e){return e&&parseInt(e)}},function(e){var a=e.input;return c.a.createElement(o.b,{name:"reading",label:"Current Reading"},function(){return c.a.createElement(d.a,Object.assign({autoComplete:"off",placeholder:n.lease.value.lastPayment&&n.lease.value.lastPayment.reading?n.lease.value.lastPayment.reading:n.lease.value.initialReading},a,{type:"number"}))})}),c.a.createElement(D,null,"Calculated Electricity Charges :"," ",c.a.createElement("span",null,n.payment.electricityCharges)),n.lease.value.extraCharges>0&&c.a.createElement(D,null,"Extra Charges :"," ",c.a.createElement("span",null,n.lease.value.extraCharges)),n.lease.value.lastPayment&&0!==n.lease.value.lastPayment.balance&&c.a.createElement(D,null,"Last Balance :"," ",c.a.createElement("span",null,n.lease.value.lastPayment.balance)),c.a.createElement(D,null,"Total Rent : ",c.a.createElement("span",null,n.totalRent)),c.a.createElement(s.a,{name:"payment.totalPaid",parse:function(e){return e&&parseInt(e)}},function(e){var a=e.input;return c.a.createElement(o.b,{name:"reading",label:"Total Paid",isRequired:!0},function(){return c.a.createElement(d.a,Object.assign({autoComplete:"off"},a,{type:"number"}))})}),c.a.createElement(D,null,"Curent Balance :"," ",c.a.createElement(S,{value:n.payment.balanceIsElectricity?0:n.payment.balance},n.payment.balanceIsElectricity?0:n.payment.balance)),!n.payment.reading&&n.payment.balance>0&&c.a.createElement(s.a,{name:"payment.balanceIsElectricity",type:"checkbox"},function(e){var a=e.input;return c.a.createElement(y.a,Object.assign({label:"Mark balance as Electricity Charge"},a,{isChecked:a.value}))}),n.payment.balanceIsElectricity&&c.a.createElement(D,null,"Paid Electricity Charges :"," ",c.a.createElement("span",null,n.payment.balance)),c.a.createElement(s.a,{name:"lease.remark"},function(e){var a=e.input;return c.a.createElement(o.b,{name:"remark",label:"Remarks"},function(){return c.a.createElement(p.a,Object.assign({resize:"smart"},a))})}),c.a.createElement(m.a,null,c.a.createElement(u.a,{type:"submit",appearance:"primary",isDisabled:t||r||!n.payment.totalPaid,isLoading:t},"Submit"))))}))}}}]);
//# sourceMappingURL=5.39c3f0bd.chunk.js.map