(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{111:function(e,n,t){e.exports=t(143)},122:function(e,n,t){},143:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(50),l=t.n(o),c=t(22),u=t(17),i=t(21),s=t(54),m=t(32),d=a.createContext(null);function f(){return a.useContext(d)}var b=t(51),p=t(11),g=(t(122),t(5)),v=t(150),E=t(99),h=t.n(E);function O(){var e=Object(p.a)(["\n  display: flex;\n  align-items: center;\n"]);return O=function(){return e},e}function w(){var e=Object(p.a)(["\n  display: flex;\n  justify-content: space-between;\n  padding: 10px 20px;\n  background: #c4a3ff;\n"]);return w=function(){return e},e}var j=g.default.nav(w()),y=g.default.div(O()),x=function(e){var n=f().history;return r.a.createElement("div",null,r.a.createElement(j,null,r.a.createElement(v.a,{onClick:function(){return n.push("/")},iconBefore:r.a.createElement(h.a,{size:"medium"})}),r.a.createElement(y,null,r.a.createElement("span",null,"Hi, ",r.a.createElement("b",null,e.user&&e.user.landlord.name)),r.a.createElement(v.a,{onClick:e.logOut,appearance:"link"},"Logout"))))};function k(){var e=Object(p.a)(["\n  padding: 2rem;\n"]);return k=function(){return e},e}function S(){var e=Object(p.a)(["\n  width: 400px;\n  max-width: 100%;\n  margin: 10% auto;\n  background-color: #fbfbfb;\n  box-shadow: 0 0px 20px #e7e7e7;\n"]);return S=function(){return e},e}function C(){var e=Object(p.a)(["\n  background-color: rgb(45, 51, 58);\n  padding: 1rem;\n  color: #fff;\n"]);return C=function(){return e},e}var P=g.default.header(C()),R=g.default.div(S()),_=g.default.div(k()),L=function(e){var n=e.component,t=e.title,a=Object(b.a)(e,["component","title"]);return r.a.createElement(m.b,Object.assign({},a,{render:function(e){return r.a.createElement(R,null,r.a.createElement(P,null,t),r.a.createElement(_,null,r.a.createElement(n,e)))}}))},I=t(43),U=t(26),$=t(75);var A=function(e){var n=e.userState,t=Object(U.c)($.b,{variables:{landlordId:n.user.landlord._id}}),a=t.data,o=t.loading;return r.a.createElement("div",{style:{padding:"1rem"}},r.a.createElement("h2",null,"Rooms"),o?r.a.createElement(I.a,{size:"medium"}):a.rooms.map(function(e){return r.a.createElement("div",{key:e.roomNo},r.a.createElement("h4",null,e.roomNo," -"," ",e.currentLease?e.currentLease.tenant.name:"Vacant"))}))};function q(){var e=Object(p.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n  padding: 1rem;\n  border-left: 1px dotted;\n"]);return q=function(){return e},e}function N(){var e=Object(p.a)(["\n  display: flex;\n  justify-content: space-between;\n"]);return N=function(){return e},e}var T=g.default.div(N()),W=g.default.div(q());var z=function(){var e=Object(i.b)().userState,n=f().history;return r.a.createElement(T,null,r.a.createElement(A,{userState:e}),r.a.createElement(W,null,r.a.createElement(v.a,{type:"submit",appearance:"primary",onClick:function(){return n.push("payment/accept")}},"Accept Payment"),r.a.createElement(v.a,{type:"submit",appearance:"subtle",onClick:function(){return n.push("tenants/add")}},"Add Tenant"),r.a.createElement(v.a,{type:"submit",appearance:"subtle"},"End Lease")))},V=t(60),F=t(34),H=t(149),J=t(151),B=t(70),Y=t(61),G=t(148),M=t(154);function Q(){var e=Object(p.a)(["\n  mutation LogIn($username: String!, $password: String!) {\n    logIn(username: $username, password: $password) {\n      token\n      user {\n        _id\n        username\n        landlord {\n          _id\n          name\n        }\n      }\n    }\n  }\n"]);return Q=function(){return e},e}var D=Object(c.b)(Q()),K=function(){var e=Object(i.b)(),n=e.setUser,t=e.userState,o=f().history,l=Object(U.b)(D,{onCompleted:function(e){n(e.logIn),o.push("/")}}),c=Object(F.a)(l,2),u=c[0];return Object(V.a)(c[1]),Object(a.useEffect)(function(){t.user&&o.push("/")},[t.user]),r.a.createElement(B.c,{onSubmit:function(e){return u({variables:e})}},function(e){var n=e.formProps,t=e.submitting;return r.a.createElement("form",n,r.a.createElement(Y.b,{name:"username",label:"Username",isRequired:!0,defaultValue:""},function(e){var n=e.fieldProps;return e.error,r.a.createElement(J.a,Object.assign({autoComplete:"off"},n))}),r.a.createElement(Y.b,{name:"password",label:"Password",defaultValue:"",isRequired:!0,validate:function(e){return e.length<8?"TOO_SHORT":void 0}},function(e){var n=e.fieldProps,t=e.error;return e.valid,r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,Object.assign({type:"password",autoComplete:"off"},n)),t&&r.a.createElement(G.a,null,"Wrong Password"))}),r.a.createElement(M.a,null,r.a.createElement(H.a,null,r.a.createElement(v.a,{onClick:function(){return o.push("/register")},appearance:"subtle"},"Register"),r.a.createElement(v.a,{type:"submit",appearance:"primary",isLoading:t},"Login"))))})};function X(){var e=Object(p.a)(["\n  mutation CreateUser($name: String!, $username: String!, $password: String!) {\n    createUser(name: $name, username: $username, password: $password) {\n      token\n      user {\n        _id\n        username\n        landlord {\n          _id\n          name\n        }\n      }\n    }\n  }\n"]);return X=function(){return e},e}var Z=Object(c.b)(X()),ee=function(){var e=Object(i.b)().setUser,n=f().history,t=Object(U.b)(Z,{onCompleted:function(t){e(t.createUser),n.push("/")}}),a=Object(F.a)(t,2),o=a[0];return Object(V.a)(a[1]),r.a.createElement(B.c,{onSubmit:function(e){return o({variables:e})}},function(e){var t=e.formProps,a=e.submitting;return r.a.createElement("form",t,r.a.createElement(Y.b,{name:"name",label:"Name",isRequired:!0,defaultValue:""},function(e){var n=e.fieldProps,t=e.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,Object.assign({autoComplete:"off"},n)),!t&&r.a.createElement(G.b,null,"You can only use letters."))}),r.a.createElement(Y.b,{name:"username",label:"User name",isRequired:!0,defaultValue:""},function(e){var n=e.fieldProps,t=e.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,Object.assign({autoComplete:"off"},n)),!t&&r.a.createElement(G.b,null,"You can use letters & numbers."),t&&r.a.createElement(G.a,null,"This user name is already in use, try another one."))}),r.a.createElement(Y.b,{name:"password",label:"Password",defaultValue:"",isRequired:!0,validate:function(e){return e.length<8?"TOO_SHORT":void 0}},function(e){var n=e.fieldProps,t=e.error,a=e.valid;return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,Object.assign({type:"password"},n)),!t&&!a&&r.a.createElement(G.b,null,"Use 8 or more characters with a mix of letters, numbers & symbols."),t&&r.a.createElement(G.a,null,"Password needs to be more than 8 characters."),a&&r.a.createElement(G.c,null,"Awesome password!"))}),r.a.createElement(M.a,null,r.a.createElement(H.a,null,r.a.createElement(v.a,{onClick:function(){return n.push("/login")},appearance:"subtle"},"Login"),r.a.createElement(v.a,{type:"submit",appearance:"primary",isLoading:a},"Register"))))})};function ne(){var e=Object(p.a)(["\n  max-width: 700px;\n  min-height: 80vh;\n  margin: 5% auto 0;\n  box-shadow: 0 0px 20px #e7e7e7;\n  background-color: #fbfbfb;\n"]);return ne=function(){return e},e}var te=Object(a.lazy)(function(){return Promise.all([t.e(0),t.e(6)]).then(t.bind(null,450))}),ae=Object(a.lazy)(function(){return Promise.all([t.e(0),t.e(4),t.e(5)]).then(t.bind(null,456))}),re=Object(a.lazy)(function(){return t.e(7).then(t.bind(null,451))}),oe=g.default.div(ne());var le=function(e){var n=e.component,t=Object(b.a)(e,["component"]),a=Object(i.b)(),o=a.userState,l=a.logOut;return r.a.createElement(m.b,Object.assign({},t,{render:function(e){return o.user?r.a.createElement(r.a.Fragment,null,r.a.createElement(x,{user:o.user,logOut:l}),r.a.createElement("main",null,r.a.createElement(n,e))):r.a.createElement(m.a,{to:{pathname:"/login"}})}}))},ce=function(){return Object(i.b)().userState.loaded?r.a.createElement(m.d,null,r.a.createElement(L,{path:"/login",exact:!0,component:K,title:"Login"}),r.a.createElement(L,{path:"/register",exact:!0,component:ee,title:"Register"}),r.a.createElement(oe,null,r.a.createElement(a.Suspense,{fallback:r.a.createElement(I.a,{size:"large"})},r.a.createElement(le,{path:"/",exact:!0,component:z}),r.a.createElement(le,{path:"/tenants/add",exact:!0,component:te}),r.a.createElement(le,{path:"/payment/accept",exact:!0,component:ae}))),r.a.createElement(m.b,{component:re})):r.a.createElement(I.a,{size:"medium"})},ue=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ie(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}console.log("REACT_APP_GRAPHQL_URI ==>","http://localhost:9000/graphql");var se=new c.a({uri:"http://localhost:9000/graphql",headers:{"x-token":localStorage.getItem("x-token")}});l.a.render(r.a.createElement(u.a,{client:se},r.a.createElement(i.a,null,r.a.createElement(function(e){var n=e.children;return a.createElement(s.a,null,a.createElement(m.b,null,function(e){return a.createElement(d.Provider,{value:e},n)}))},null,r.a.createElement(ce,null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("","/service-worker.js");ue?(function(e,n){fetch(e).then(function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ie(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ie(n,e)})}}()},21:function(e,n,t){"use strict";t.d(n,"a",function(){return f}),t.d(n,"b",function(){return b});var a=t(34),r=t(11),o=t(0),l=t.n(o),c=t(26),u=t(22);function i(){var e=Object(r.a)(["\n  {\n    me {\n      _id\n      username\n      landlord {\n        _id\n        name\n      }\n    }\n  }\n"]);return i=function(){return e},e}var s=Object(u.b)(i()),m={user:void 0,loaded:!1},d=l.a.createContext({userState:m,setUser:function(){},logOut:function(){}}),f=function(e){var n=Object(o.useState)(m),t=Object(a.a)(n,2),r=t[0],u=t[1],i=Object(c.a)(s,{variables:{asfas:!0},onCompleted:function(e){var n=e.me;console.log("onCompleted"),console.log("data",n),u({user:n})}}),f=Object(a.a)(i,2);f[0],f[1].data;Object(o.useEffect)(function(){var e=localStorage.getItem("x-token");console.log("token ==>",e),e&&"undefined"!==e?(console.log("getMe"),u({loaded:!0,user:JSON.parse(localStorage.getItem("user"))})):u({loaded:!0})},[]);return l.a.createElement(d.Provider,{value:{userState:r,setUser:function(e){console.log("data ==>",e),localStorage.setItem("x-token",e.token),localStorage.setItem("user",JSON.stringify(e.user)),u({user:e.user,loaded:!0})},logOut:function(){localStorage.removeItem("x-token"),u({user:void 0,loaded:!0})}}},e.children)},b=function(){return Object(o.useContext)(d)}},43:function(e,n,t){"use strict";t.d(n,"a",function(){return s}),t.d(n,"b",function(){return i});var a=t(11),r=t(0),o=t.n(r),l=t(5),c=t(145);function u(){var e=Object(a.a)(["\n  text-align: center;\n  margin-top: 2rem;\n"]);return u=function(){return e},e}var i=l.default.div(u()),s=function(e){return o.a.createElement(i,null,o.a.createElement(c.a,e))}},75:function(e,n,t){"use strict";t.d(n,"b",function(){return c}),t.d(n,"a",function(){return u});var a=t(11),r=t(22);function o(){var e=Object(a.a)(["\n  query {\n    currentLeases {\n      _id\n      rent\n      initialReading\n      tenant {\n        name\n      }\n      lastPayment {\n        reading\n        balance\n      }\n      room {\n        roomNo\n      }\n    }\n  }\n"]);return o=function(){return e},e}function l(){var e=Object(a.a)(["\n  query getRooms($landlordId: String!) {\n    rooms(_id: $landlordId) {\n      _id\n      roomNo\n      currentLease {\n        _id\n        rent\n        current\n        tenant {\n          name\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c=Object(r.b)(l()),u=Object(r.b)(o())}},[[111,2,3]]]);
//# sourceMappingURL=main.624a3e31.chunk.js.map